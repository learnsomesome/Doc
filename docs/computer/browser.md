# 浏览器进程架构

#### 进程与线程

##### 定义

- 进程：应用程序的运行实例。

- 线程：不能单独存在，由进程来启动与管理。

  > 操作系统划分内存供不同**进程**运行，进程内通过划分不同**线程**来管理多个子任务。

  <img src="https://pic3.zhimg.com/80/v2-8d714113f9f709a7458fade1342332f6_720w.jpg" alt="进程与线程"  />

##### 区别与联系

- 线程之间共享进程中的数据。
- 进程中的任意一线程执行出错，都会导致整个进程的崩溃。
- 当一个进程关闭之后，操作系统会回收进程所占用的内存。
- 进程之间的内容相互隔离。另外，进程之间的数据通信，需要使用进程间通信（IPC）进制。

#### 浏览器进程架构

##### 演变历史

- **单进程架构**

  浏览器的所有功能模块都是运行在同一个进程里，这些模块包含了网络、插件、JavaScript 运行环境、渲染引擎和页面等。

  ![单进程架构](https://pic4.zhimg.com/80/v2-a70398b6e60aff11da6a405d2d1497c7_720w.jpg)

  缺点：不稳定 / 不流畅 / 不安全

- **多进程架构**

  将浏览器的各种不同类别的任务拆分出来，放到多个不同的进程中去执行。

  > 💡 如何解决单进程架构存在的问题？

##### Chrome 多进程架构

![Chrome 多进程架构](https://pic4.zhimg.com/80/v2-60615d290fefbb2228256258dd2963d3_720w.jpg)

> Chrome的多进程架构中包含**浏览器主进程**、**渲染进程**、**插件进程**、**网络进程**、**GPU进程**。

- **沙盒技术(Sandbox)**

  > 一个被限制了权限的进程。

- **站点隔离(Site Isolation)**

  > 同一个域下的内容，会放在同一个渲染进程中进行渲染。

  - **同站点**：相同的根域名、协议。还包含了该根域名下的所有子域名和不同端口。
  - **同源**：相同的域名、协议、端口。

- **未来-面向服务架构**

  - **SOA**：根据 Chrome 基础服务划分进程
  - **弹性架构**：根据系统内存动态划分及合并浏览器主进程

